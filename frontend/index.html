<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ³ Tarif-e - AkÄ±llÄ± Mutfak AsistanÄ±</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/static/favicon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/static/favicon-512.png">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Tarif-e">

    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/themes.css">
    <link rel="stylesheet" href="/static/css/share.css">
    <link rel="stylesheet" href="/static/css/nutrition.css">
    <link rel="stylesheet" href="/static/css/mobile.css">
    <link rel="stylesheet" href="/static/css/filters.css">

    <style>
        /* Modern YumuÅŸak Arka Plan */
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e3e9f0 50%, #d5dce6 100%);
            background-attachment: fixed;
            min-height: 100vh;
        }

        /* Hafif pattern overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                radial-gradient(circle at 20% 30%, rgba(102, 126, 234, 0.04) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(118, 75, 162, 0.04) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* Container'larÄ± daha belirgin yap */
        .container, .screen {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.filter-btn {
    padding: 10px 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.filter-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

/* Pro Badge Animation */
@keyframes pulse-gold {
    0%, 100% {
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }
    50% {
        box-shadow: 0 0 25px rgba(255, 215, 0, 0.8);
    }
}

    </style>

    <script>
        // Token yoksa login'e yÃ¶nlendir
        if (!localStorage.getItem('access_token')) {
            window.location.href = '/login.html';
        }
    </script>
</head>

<body>
<!-- User Info & Logout Bar -->
<div id="user-info-bar" style="
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 60px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    z-index: 1000;
">

    <span class="logo">
        <span class="logo-icon">ğŸ”</span>
        <span class="logo-text">Tarif-e</span>
    </span>

    <!-- User Info & Logout -->
    <div style="display: flex; align-items: center; gap: 15px;">
        <!-- KullanÄ±cÄ± Bilgisi -->
        <div style="display: flex; align-items: center; gap: 10px;">
            <div id="user-display" style="
                background: rgba(255,255,255,0.2);
                color: white;
                padding: 8px 15px;
                border-radius: 20px;
                font-weight: 600;
                backdrop-filter: blur(10px);
            "></div>

            <!-- Pro Badge -->
            <div id="subscription-badge" style="display: none;">
                <span id="pro-badge" style="
                    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
                    color: #333;
                    padding: 6px 12px;
                    border-radius: 15px;
                    font-weight: 700;
                    font-size: 12px;
                    letter-spacing: 0.5px;
                    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
                    animation: pulse-gold 2s infinite;
                    display: none;
                ">âœ¨ PRO</span>

                <span id="standard-badge" style="
                    background: rgba(255, 255, 255, 0.3);
                    color: white;
                    padding: 6px 12px;
                    border-radius: 15px;
                    font-weight: 600;
                    font-size: 12px;
                    letter-spacing: 0.5px;
                    border: 1px solid rgba(255, 255, 255, 0.4);
                    display: none;
                ">STANDARD</span>
            </div>
        </div>

        <!-- Profil Butonu -->
        <button onclick="window.location.href='/profile.html'" style="
            padding: 8px 20px;
            background: rgba(255,255,255,0.25);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        "  onmouseover="this.style.background='rgba(255,255,255,0.35)'; this.style.transform='translateY(-2px)'"
           onmouseout="this.style.background='rgba(255,255,255,0.25)'; this.style.transform='translateY(0)'">
            âš™ï¸ Profil
        </button>

        <!-- Logout Butonu -->
        <button onclick="window.handleLogout()" style="
            padding: 8px 20px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
        "  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0,0,0,0.3)'"
           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)'">
            ğŸšª Ã‡Ä±kÄ±ÅŸ
        </button>
    </div>
</div>

<!-- Main Content Spacer - User bar iÃ§in boÅŸluk bÄ±rakÄ±r -->
<div style="height: 60px;"></div>

    <!-- Main Content Spacer - User bar iÃ§in boÅŸluk bÄ±rakÄ±r -->
    <div style="height: 60px;"></div>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>ğŸ³ Tarif-e</h1>
            <p class="subtitle">AkÄ±llÄ± Mutfak AsistanÄ±</p>
        </header>

        <!-- Ana MenÃ¼ -->
        <div id="main-menu" class="screen active">
            <div class="button-group">
                <button class="btn btn-primary" onclick="showScreen('camera-screen')" id="photo-menu-btn">
                    <span id="photo-icon">ğŸ“·</span>
                    <span id="photo-text">FotoÄŸraf Ã‡ek</span>
                </button>
                <button class="btn btn-secondary" onclick="showScreen('manual-screen')">
                    âœï¸ Manuel Ekle
                </button>
                <button class="btn btn-tertiary" onclick="showScreen('my-ingredients-screen')">
                    ğŸ—‚ï¸ Malzemelerim
                </button>
                <button class="btn" style="background: #F6AD55; color: white;" onclick="loadShoppingLists(); showScreen('shopping-lists-screen');">
                    ğŸ›’ AlÄ±ÅŸveriÅŸ Listelerim
                </button>
                <button class="btn" style="background: #F59E0B; color: white;" onclick="loadFavorites(); showScreen('favorites-screen');">
                    â­ Favori Tariflerim
                </button>
                <button class="btn" style="background: #9F7AEA; color: white;" onclick="loadInvitations(); showScreen('invitations-screen');">
                    ğŸ”” Davetlerim
                </button>
                <button class="btn" style="background: #4299E1; color: white;" onclick="loadSharedLists(); showScreen('shared-lists-screen');">
                    ğŸ‘¥ PaylaÅŸÄ±lan Listeler
                </button>
                <button class="btn" style="background: linear-gradient(135deg, #FC8181 0%, #F56565 100%); color: white;" onclick="window.location.href='/menu-planner.html';">
                    ğŸ“… MenÃ¼ PlanlayÄ±cÄ±
                </button>
            </div>

            <div class="status-bar">
                <span id="ai-status">ğŸ¤– AI: Aktif</span>
                <button class="btn-settings" onclick="showScreen('settings-screen')">âš™ï¸</button>
            </div>
        </div>
        <!-- AlÄ±ÅŸveriÅŸ Listelerim EkranÄ± -->
        <div id="shopping-lists-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <h2>ğŸ›’ AlÄ±ÅŸveriÅŸ Listelerim</h2>
            <div id="shopping-lists-container"></div>
        </div>

<!-- AlÄ±ÅŸveriÅŸ Listesi Detay EkranÄ± -->
<div id="shopping-detail-screen" class="screen">
    <button class="btn-back" onclick="showScreen('shopping-lists-screen')">â† Geri</button>

    <div id="shopping-detail-header"></div>
    <div id="shopping-detail-items"></div>

    <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
        <button class="btn" style="background: #48BB78; color: white;" onclick="showAddItemModal()">
            â• ÃœrÃ¼n Ekle
        </button>
        <button class="btn btn-success" id="complete-list-btn" onclick="completeShoppingList()">
            âœ… AlÄ±ÅŸveriÅŸi Tamamla
        </button>
        <button class="btn" style="background: #FC8181; color: white;" onclick="deleteShoppingList()">
            ğŸ—‘ï¸ Listeyi Sil
        </button>
        <button class="btn" style="background: #9F7AEA; color: white;" onclick="showShareModal(currentShoppingListId)">
            ğŸ‘¥ PaylaÅŸ
        </button>
    </div>
</div>

<!-- AlÄ±ÅŸveriÅŸ Listesine ÃœrÃ¼n Ekleme Modal -->
        <div id="add-item-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>ÃœrÃ¼n Ekle</h3>

                <div class="form-group">
                    <label>Malzeme AdÄ±:</label>
                    <input type="text" id="add-item-name" class="input" placeholder="Ã¶rn: yumurta">

                    <label>Miktar:</label>
                    <input type="number" id="add-item-amount" class="input" step="0.1" min="0" value="1">

                    <label>Birim:</label>
                    <select id="add-item-unit" class="input">
                        <option value="adet">Adet</option>
                        <option value="kg">Kilogram</option>
                        <option value="gram">Gram</option>
                        <option value="litre">Litre</option>
                        <option value="ml">Mililitre</option>
                        <option value="paket">Paket</option>
                        <option value="kutu">Kutu</option>
                        <option value="demet">Demet</option>
                    </select>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-success" onclick="addItemToShoppingList()">ğŸ’¾ Ekle</button>
                        <button class="btn btn-secondary" onclick="closeAddItemModal()">âŒ Ä°ptal</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Kamera EkranÄ± -->
        <!-- FotoÄŸraf Ã‡ek/YÃ¼kle EkranÄ± -->
        <div id="camera-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <h2 id="camera-screen-title">ğŸ“· FotoÄŸraf Ã‡ek</h2>

            <div class="camera-container">
                <input
                    type="file"
                    id="photo-input"
                    accept="image/*"
                    capture="environment"
                    style="display: none;"
                    onchange="handlePhotoSelect(event)"
                >
                <label for="photo-input" class="camera-button" id="camera-label">
                    <span id="camera-label-icon">ğŸ“·</span>
                    <span id="camera-label-text">FotoÄŸraf Ã‡ek</span>
                </label>

                <div id="photo-preview" class="photo-preview"></div>
                <div id="detected-ingredients" class="detected-ingredients"></div>
            </div>

            <button id="get-recipe-btn" class="btn btn-success" onclick="getRecipeFromPhoto()" style="display: none;">
                ğŸ½ï¸ Tarif Ã–ner
            </button>
        </div>

        <!-- Manuel Ekleme EkranÄ± -->
        <div id="manual-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <h2>Malzeme Ekle</h2>

            <div class="form-group">
                <input type="text" id="ingredient-name" placeholder="Malzeme adÄ± (Ã¶rn: domates)" class="input">
                <input type="number" id="ingredient-amount" placeholder="Miktar" class="input" value="1">
                <select id="ingredient-unit" class="input">
                    <option value="adet">Adet</option>
                    <option value="kg">Kilogram</option>
                    <option value="gram">Gram</option>
                    <option value="litre">Litre</option>
                    <option value="ml">Mililitre</option>
                </select>
                <button class="btn btn-primary" onclick="addManualIngredient()">â• Ekle</button>
            </div>

            <div id="manual-ingredients-list"></div>
        </div>

        <!-- Malzemelerim EkranÄ± -->
        <div id="my-ingredients-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <div class="section-header">
                <h2>Malzemelerim</h2>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button class="btn" style="background: #667eea; color: white; padding: 8px 15px;" onclick="selectAllIngredients()">
                        âœ“ TÃ¼mÃ¼nÃ¼ SeÃ§
                    </button>
                    <button class="btn" style="background: #718096; color: white; padding: 8px 15px;" onclick="deselectAllIngredients()">
                        âœ— TÃ¼mÃ¼nÃ¼ KaldÄ±r
                    </button>
                </div>
            </div>

            <div id="my-ingredients-list" class="ingredients-list"></div>

            <div style="margin-top: 20px; padding: 15px; background: #EDF2F7; border-radius: 8px;">
                <p id="selected-ingredients-count" style="margin: 0; color: #4A5568; font-weight: 600;">
                    0 malzeme seÃ§ildi
                </p>
            </div>

            <button class="btn btn-success" onclick="getTarifFromMyIngredients()">
                ğŸ½ï¸ SeÃ§ili Malzemelerden Tarif Ã–ner
            </button>
        </div>

        <!-- Malzeme DÃ¼zenleme Modal -->
        <div id="edit-ingredient-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>Malzeme DÃ¼zenle</h3>

                <div class="form-group">
                    <label>Malzeme:</label>
                    <input type="text" id="edit-ingredient-name" class="input" readonly>

                    <label>Miktar:</label>
                    <input type="number" id="edit-ingredient-amount" class="input" step="0.1" min="0">

                    <label>Birim:</label>
                    <select id="edit-ingredient-unit" class="input">
                        <option value="adet">Adet</option>
                        <option value="kg">Kilogram</option>
                        <option value="gram">Gram</option>
                        <option value="litre">Litre</option>
                        <option value="ml">Mililitre</option>
                    </select>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-success" onclick="saveIngredientUpdate()">ğŸ’¾ Kaydet</button>
                        <button class="btn btn-secondary" onclick="closeEditModal()">âŒ Ä°ptal</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarif EkranÄ± -->
        <div id="recipe-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <div id="recipe-details"></div>

            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="getNewRecipe()">
                    ğŸ”„ Yeni Tarif Ã–ner
                </button>
                <button class="btn" style="background: #F6AD55; color: white;" onclick="addRecipeToFavorites()">
                    â­ Favorilere Ekle
                </button>
                <button class="btn btn-success" onclick="createShoppingList()">
                    ğŸ›’ AlÄ±ÅŸveriÅŸ Listesi OluÅŸtur
                </button>
            </div>
        </div>

        <!-- Favori Tarifler EkranÄ± -->
        <div id="favorites-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <h2>â­ Favori Tariflerim</h2>
            <button onclick="openFilterModal()" class="filter-btn">
                ğŸ” GeliÅŸmiÅŸ Filtre
            </button>
            <div id="favoriler-container"></div>
        </div>

        <!-- Favori Tarif Detay EkranÄ± -->
        <div id="favorite-detail-screen" class="screen">
            <button class="btn-back" onclick="showScreen('favorites-screen')">â† Favorilere DÃ¶n</button>

            <div id="favorite-recipe-details"></div>

            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-success" onclick="createShoppingListFromFavorite()">
                    ğŸ›’ AlÄ±ÅŸveriÅŸ Listesi OluÅŸtur
                </button>
                <button class="btn" onclick="printFavoriteRecipe()"
                    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                ğŸ–¨ï¸ Tarifi YazdÄ±r
                </button>
                <button class="btn" style="background: #FC8181; color: white;" onclick="deleteFavoriteRecipe()">
                    ğŸ—‘ï¸ Favorilerden Ã‡Ä±kar
                </button>
                <button class="btn btn-share"
                        onclick="openShareModal(currentRecipe)"
                        style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);">
                    ğŸ“¤ PaylaÅŸ
                </button>
                <button class="btn btn-nutrition"
                        onclick="openNutritionModal(currentRecipe)"
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    ğŸ“Š Besin DeÄŸerleri
                </button>
            </div>
        </div>

        <!-- Ayarlar EkranÄ± -->
        <div id="settings-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>

            <h2>âš™ï¸ Ayarlar</h2>

            <div class="settings-group">
                <h3>ğŸ¤– AI KullanÄ±m Modu</h3>
                <select id="ai-mode-select" class="input" onchange="updateAIMode()">
                    <option value="auto">Otomatik (Her zaman AI)</option>
                    <option value="manual">Manuel (AI kullanma)</option>
                    <option value="hybrid">Hibrit (GerektiÄŸinde)</option>
                    <option value="off">KapalÄ± (Sadece offline)</option>
                </select>
                <p class="help-text">Otomatik: En hÄ±zlÄ± ve kolay, internet gerekli</p>
            </div>

            <div class="settings-group">
                <h3>ğŸ”’ Gizlilik</h3>
                <label class="checkbox-label">
                    <input type="checkbox" id="data-sharing" checked>
                    Anonim kullanÄ±m verisi paylaÅŸ (uygulamayÄ± geliÅŸtirmek iÃ§in)
                </label>
            </div>

            <div class="settings-group">
                <h3>â„¹ï¸ Bilgiler</h3>
                <p>Versiyon: 0.1.0</p>
                <p>AI Kota: <span id="ai-quota">10</span> / ay (Free tier)</p>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>YÃ¼kleniyor...</p>
        </div>

        <!-- Davetler EkranÄ± -->
        <div id="invitations-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>
            <h2>ğŸ”” Davetlerim</h2>
            <p style="color: #718096; margin-bottom: 20px;">
                Sizinle paylaÅŸÄ±lan alÄ±ÅŸveriÅŸ listesi davetleri
            </p>
            <div id="invitations-container"></div>
        </div>

        <!-- PaylaÅŸÄ±lan Listeler EkranÄ± -->
        <div id="shared-lists-screen" class="screen">
            <button class="btn-back" onclick="goBack()">â† Geri</button>
            <h2>ğŸ‘¥ Benimle PaylaÅŸÄ±lan Listeler</h2>
            <p style="color: #718096; margin-bottom: 20px;">
                DiÄŸer kullanÄ±cÄ±larÄ±n sizinle paylaÅŸtÄ±ÄŸÄ± listeler
            </p>
            <div id="shared-lists-container"></div>
        </div>
    </div>

    <!-- PaylaÅŸÄ±m ModalÄ± -->
    <div id="share-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <h3>ğŸ‘¥ Liste PaylaÅŸ</h3>

            <div class="form-group">
                <label>KullanÄ±cÄ± Email:</label>
                <input type="email" id="share-email-input" class="input" placeholder="ornek@email.com">

                <label style="margin-top: 15px;">Yetki Seviyesi:</label>
                <select id="share-role-select" class="input">
                    <option value="view">ğŸ‘ï¸ Sadece GÃ¶rÃ¼ntÃ¼leyebilir</option>
                    <option value="edit">âœï¸ DÃ¼zenleyebilir</option>
                </select>

                <div style="background: #EDF2F7; padding: 12px; border-radius: 8px; margin-top: 15px; font-size: 0.9em;">
                    <strong>â„¹ï¸ Bilgi:</strong>
                    <ul style="margin: 8px 0 0 20px; color: #4A5568;">
                        <li><strong>GÃ¶rÃ¼ntÃ¼leyebilir:</strong> Sadece listeyi gÃ¶rebilir</li>
                        <li><strong>DÃ¼zenleyebilir:</strong> ÃœrÃ¼n ekleyebilir/Ã§Ä±karabilir</li>
                    </ul>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn btn-success" onclick="shareList()">âœ… PaylaÅŸ</button>
                    <button class="btn btn-secondary" onclick="closeShareModal()">âŒ Ä°ptal</button>
                </div>
            </div>

            <div id="share-info-container" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #E2E8F0;"></div>
        </div>
    </div>
    <script src="/static/js/theme.js"></script>
    <script src="/static/js/app.js"></script>
    <script src="/static/js/share.js"></script>
    <script src="/static/js/nutrition.js"></script>
    <script src="/static/js/filters.js"></script>
    <script>
    function handleLogout() {
        if (confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinize emin misiniz?')) {
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');
            window.location.href = '/login.html';
        }
    }
    </script>
<script>
    const token = localStorage.getItem('access_token');

// Manual test
fetch('http://localhost:8000/api/malzeme/liste', {
    headers: {
        'Authorization': `Bearer ${token}`
    }
}).then(r => r.json()).then(d => console.log('SonuÃ§:', d));
</script>

</body>
</html>